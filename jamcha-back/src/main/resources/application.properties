# Application Configuration
spring.application.name=jamcha

spring.config.import=classpath:security-config.yml

# PostgreSQL connection (defaults to postgres service, fallback localhost)
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:jamcha_database}
spring.datasource.username=${DB_USER:jamcha_user}
spring.datasource.password=${DB_PASSWORD:jamcha_password}
spring.datasource.driver-class-name=org.postgresql.Driver

# Importing the endpoints yml file
spring.profiles.include=security

# JPA settings
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Liquibase
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.yaml

# Keycloak Configuration (defaults to keycloak container, fallback localhost:8085)
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://${KEYCLOAK_HOST:localhost}:${KEYCLOAK_PORT:8085}/realms/${KEYCLOACK_REALM:jamcha_realm}
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://${KEYCLOAK_HOST:localhost}:${KEYCLOAK_PORT:8085}/realms/${KEYCLOACK_REALM:jamcha_realm}/protocol/openid-connect/certs

# Minio configuration (defaults to minio service, fallback localhost)
minio.url=http://${MINIO_HOST:localhost}:${MINIO_PORT:9000}
minio.accessKey=${MINIO_ACCESS_KEY:jamcha}
minio.secretKey=${MINIO_SECRET_KEY:jamcha123}
minio.bucketName=${MINIO_BUCKET:jamcha-assets}

# Keycloak Admin Client Configuration
keycloak.server-url=http://${KEYCLOAK_HOST:localhost}:${KEYCLOAK_PORT:8085}
keycloak.realm=${KEYCLOACK_REALM:jamcha_realm}
keycloak.admin-realm=master
keycloak.admin-username=${KEYCLOAK_ADMIN:admin}
keycloak.admin-password=${KEYCLOAK_ADMIN_PASSWORD:admin}
keycloak.client-id=${KEYCLOACK_CLIENT_ID:jamcha-backend}
keycloak.client-secret=${KEYCLOAK_CLIENT_SECRET:jamcha-backend-secret-key-2024}

# JWT Token Configuration
jwt.expiration=3600
jwt.secret=${JWT_SECRET:default-secret-key}

# Expose health endpoint
management.endpoints.web.exposure.include=health
management.endpoint.health.enabled=true

# Show health details
management.endpoint.health.show-details=always

# App server
server.port=${SERVER_PORT:8080}
logging.level.org.springframework.web=DEBUG
